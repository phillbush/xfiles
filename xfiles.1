.Dd December 25, 2022
.Dt XFILES 1
.Os
.Sh NAME
.Nm xfiles
.Nd X11 file manager
.Sh SYNOPSIS
.Nm prog
.Op Fl a
.Op Fl c Ar cmd
.Op Fl g Ar geometry
.Op Fl n Ar name
.Op Ar directory
.Sh DESCRIPTION
.Nm
is a file manager for X11.
.Nm
uses other programs to perform several tasks,
such as open a file, generate thumbnails, or run arbitrary commands.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl a
Include directory entries whose name begin with a dot.
.It Fl c Ar cmd
Set the context command to
.Ar cmd
The context command is the command to be run when the user clicks the third mouse button.
Usually, this command is a program that pops up a menu when the user right-clicks
.Nm .
The paths to selected files are passed as arguments to this command.
The command is run in the directory currently open at
.Nm .
If this option is not given,
.Nm
uses the value of the
.Ev "XFILES_CONTEXTCMD"
environment variable as the context command.
.It Fl g Ar geometry
Set window size and position as specified in
.Xr XParseGeometry 3 .
.It Fl n Ar name
Specify the
.Ic res_name
member of the
.Xr XClassHint 3
property.
.Ar name
is used to retrieve resources.
If not specified, defaults to
the name of the command
.Nm
was invoked as (that is, the
.Xr basename 3
of its
.Ic "argv[0]" ) .
.El
.Pp
If no
.Ar directory
is given as argument,
.Nm
opens at the current directory.
Otherwise, it opens at the given directory.
.Sh USAGE
.Nm
is controlled mainly with the mouse,
but some actions can also be performed with the keyboard.
.Pp
.Nm
has four modes of operation, activated via mouse.
In each mode, some mouse or keyboard actions are allowed while others are not.
The modes of operation are as follows.
.Bl -tag -width Ds
.It Normal Mode
This is the mode which
.Nm
starts in.
All actions, except rectangular selection and scroller manipulation,
can be performed while in this mode.
All other modes are accessible from the normal mode.
.It Selection Mode
This mode is entered after dragging the pointer with the first button in normal mode.
In this mode, a rectangle can be drawn, in which any file inside it can be selected.
No action other than the rectangular selection can be performed while in this mode.
To exit this mode, release the first mouse button.
.It Scroll Mode
This mode is entered after opening the scroller with the second button in normal mode.
In this mode, the file list can be scrolled up and down by moving the mouse.
No action other than scrolling can be performed while in this mode.
To exit this mode, press the second mouse button
(or release it, if the pointer had not been released nor moved outside the scroller).
.It Context Mode
This mode is entered after pressing the third mouse button or the Menu key.
In this mode,
.Nm
is waiting for the context command to exit.
No action can be performed while in this mode.
To exit this mode, the context command must return.
.El
.Ss Mouse
.Nm
The first mouse button (usually the left one) is used for selection and opening.
Selecting one or more files copies their paths into the PRIMARY X selection.
Opening a single file invokes the command specified by the
.Ev OPENER
environment variable with the path to the open file as argument.
The
.Ev OPENER
program is invoked in the directory currently open at
.Nm ;
and the environment variable
.Ev "WINDOWID" ,
containing the window id of
.Nm ,
is visible to its process.
.Bl -bullet
.It
A single click with no modifier on a file's icon selects it (deselecting any other file).
.It
A double click with no modifier selects and opens it (deselecting any other file).
.It
A single click with a Control modifier does not deselect previously selected files,
but adds the clicked file to the selection list instead.
.It
A single click with a Shift modifier adds to the selection list any file between
the previously selected one and the clicked one.
.It
A dragging motion (press, drag, then release) with no modifier
draws a rectangle selecting anything inside it (deselecting any other file).
.It
A dragging motion (press, drag, then release) with either the Control or Shift modifiers
draws a rectangle adding to the selection list anything inside it.
.El
.Pp
The second, fourth and fifth buttons (the middle button click, scroll up and scroll down)
are used for scrolling.  No modifier applies to those buttons.
Some of them pop up the scroller.
The scroller is a small widget that replaces the scrollbar in
.Nm ;
it can be used either as a scrollbar or as Firefox's autoScroll.
.Bl -bullet
.It
A press on the second button pops up the scroller.
Moving the pointer up or down scrolls the list of files up or down.
If the button is release while the pointer is outside the scroller, the scroller is closed.
.It
After pressing the second button (as in the previous bullet item),
if it is released while the pointer is inside the scroller, the scroller is not closed.
The scroller handle (a small bar inside the scroller) can be dragged up and down,
scrolling the list of files up or down.
Pressing any button closes the scroller.
.It
Holding the fourth button scrolls the list of files up.
.It
Holding the fifth button scrolls the list of files down.
.El
.Pp
The third button (usually the right one) is used for context command invocation.
The context command is a program specified either with the
.Fl c
command-line option or the
.Ev "XFILES_CONTEXTCMD"
environment variable.
This program is invoked after pressing the third mouse button.
It is invoked in the directory currently open at
.Nm ;
and the environment variable
.Ev "WINDOWID" ,
containing the window id of
.Nm ,
is visible to its process.
No modifier applies to that button.
.Bl -bullet
.It
Pressing the third button while there are one or more files selected
invokes the context command with the paths of all the selected files passed as arguments.
.It
Pressing the third button on a file's icon while there's no file selected
selects that file and invokes the context command with its path passed as argument.
.It
Pressing the third button on nothing while there's no file selected
invokes the context command with no argument.
.El
.Pp
The sixth and seventh mouse buttons (scroll left and scroll right) are not used, since
.Nm
does not scroll horizontally.
.Pp
The eighth and ninth mouse buttons (previous and next) are used for navigating
through the browsing history.
.Bl -bullet
.It
Clicking the eigth mouse button goes to the previously open directory.
.It
Clicking the ninth mouse button goes to the next open directory.
.El
.Ss Keyboard
The following keys (and their number keyboard counterparts) can control
.Nm .
.Bl -tag -width Ds
.It Escape
Deselect everything.
.It Enter/Return
Select and open highlighted file.
.It Menu
Invoke context command on selected files.
.It Space
Select highlighted file.
.It PageUp
Scroll up.
.It PageDown
Scroll down.
.It Home
Highlight and select the first file (deselecting any other file).
If modified by Control, does not deselect previously selected files.
If modified by Shift, does not deselect previously selected files,
and select any file between the first file and the previously highlighted one.
.It End
Highlight and select the last file (deselecting any other file).
If modified by Control, does not deselect previously selected files.
If modified by Shift, does not deselect previously selected files,
and select any file between the last file and the previously highlighted one.
.It Left, Down, Up, Right
Highlight and select the file in the given direction (deselecting any other file).
If modified by Control, does not deselect previously selected files.
If modified by Shift, does not deselect previously selected files,
and select any file between the target file and the previously highlighted one.
.It F5
Refresh the current directory.
.It BackSpace
Go to parent directory.
.El
.Sh RESOURCES
.Nm understands the following X resources.
They must be prefixed with either the
.Qq "XFiles"
class or the name given with the
.Fl n
command-line option, followed by a period.
.Bl -tag -width Ds
.It Ic faceName
Font for drawing text.
.It Ic background
Background color.
.It Ic foreground
Text color.
.It Ic selbackground
Background color for selected entries.
.It Ic selforeground
Text color for selected entries.
.El
.Sh ENVIRONMENT
The following environment variables affect the execution of
.Nm Ns .
.Bl -tag -width Ds
.It Ev DISPLAY
The display to start
.Nm
on.
.It XFILES_ICONS
Newline-separated list of icon specifications.
Each linemust have the following format:
.Ic "[TYPE:][GLOB1|GLOB2|...|GLOBN]=PATH"
.Bl -bullet
.It
.Ic "TYPE"
is a string of characters that must be in the file's type.
For example, the
TYPE
.Qq "d"
matches a directory,
.Qq "dl"
matches a link to a directory, and
.Qq "-x"
matches any regular executable file.
.It
.Ic "GLOB1"
until
.Ic "GLOBN"
are bar-delimited glob strings that must match the entry being displayed by XFiles,
for example,
.Qq "*.png|*.jpg"
matches files with png or jpg extension.
.It
.Ic "PATH"
is the path to the icon in X Pixmap (xpm) format.
.El
.It Ev OPENER
Program to be called to open files.
Defaults to
.Xr xdg-open 1 .
.It Ev XFILES_THUMBNAILER
Program to be called to generate thumbnails.
The first argument passed to such program is the path to the existent file or directory.
The second argument is the path to the thumbnail image to be created in the PPM format.
.It Ev XFILES_THUMBNAILDIR
Path to the directory where thumbnails must be saved.
.It Ev XFILES_CONTEXTCMD
Name of the command to be run on right clicking when the
.Fl -c
option is not given.
.El
.Pp
The following environment variables are set by
.Nm
and can affect the execution of the commands run by it.
.Bl -tag -width Ds
.It Ev "WINDOWID"
A string containing the id number, in decimal ASCII characters,
of the X Window created by the current
.Nm
process.
Note that this string contains the number in decimal notation,
not in hexadecimal (as is usually exchanged by a few X applications).
.El
.Sh BUGS
Yes.
